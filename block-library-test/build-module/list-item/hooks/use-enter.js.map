{"version":3,"names":["createBlock","getDefaultBlockName","cloneBlock","useRef","useRefEffect","ENTER","useSelect","useDispatch","store","blockEditorStore","useOutdentListItem","useEnter","props","replaceBlocks","selectionChange","getBlock","getBlockRootClientId","getBlockIndex","getBlockName","propsRef","current","outdentListItem","element","onKeyDown","event","defaultPrevented","keyCode","content","clientId","length","preventDefault","canOutdent","topParentListBlock","blockIndex","head","innerBlocks","slice","middle","after","tail","addEventListener","removeEventListener"],"sources":["@wordpress/block-library/src/list-item/hooks/use-enter.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tcreateBlock,\n\tgetDefaultBlockName,\n\tcloneBlock,\n} from '@wordpress/blocks';\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\nimport { ENTER } from '@wordpress/keycodes';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport useOutdentListItem from './use-outdent-list-item';\n\nexport default function useEnter( props ) {\n\tconst { replaceBlocks, selectionChange } = useDispatch( blockEditorStore );\n\tconst { getBlock, getBlockRootClientId, getBlockIndex, getBlockName } =\n\t\tuseSelect( blockEditorStore );\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\tconst outdentListItem = useOutdentListItem();\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tif ( event.defaultPrevented || event.keyCode !== ENTER ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { content, clientId } = propsRef.current;\n\t\t\tif ( content.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tconst canOutdent =\n\t\t\t\tgetBlockName(\n\t\t\t\t\tgetBlockRootClientId(\n\t\t\t\t\t\tgetBlockRootClientId( propsRef.current.clientId )\n\t\t\t\t\t)\n\t\t\t\t) === 'core/list-item';\n\t\t\tif ( canOutdent ) {\n\t\t\t\toutdentListItem();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Here we are in top level list so we need to split.\n\t\t\tconst topParentListBlock = getBlock(\n\t\t\t\tgetBlockRootClientId( clientId )\n\t\t\t);\n\t\t\tconst blockIndex = getBlockIndex( clientId );\n\t\t\tconst head = cloneBlock( {\n\t\t\t\t...topParentListBlock,\n\t\t\t\tinnerBlocks: topParentListBlock.innerBlocks.slice(\n\t\t\t\t\t0,\n\t\t\t\t\tblockIndex\n\t\t\t\t),\n\t\t\t} );\n\t\t\tconst middle = createBlock( getDefaultBlockName() );\n\t\t\t// Last list item might contain a `list` block innerBlock\n\t\t\t// In that case append remaining innerBlocks blocks.\n\t\t\tconst after = [\n\t\t\t\t...( topParentListBlock.innerBlocks[ blockIndex ]\n\t\t\t\t\t.innerBlocks[ 0 ]?.innerBlocks || [] ),\n\t\t\t\t...topParentListBlock.innerBlocks.slice( blockIndex + 1 ),\n\t\t\t];\n\t\t\tconst tail = after.length\n\t\t\t\t? [\n\t\t\t\t\t\tcloneBlock( {\n\t\t\t\t\t\t\t...topParentListBlock,\n\t\t\t\t\t\t\tinnerBlocks: after,\n\t\t\t\t\t\t} ),\n\t\t\t\t  ]\n\t\t\t\t: [];\n\t\t\treplaceBlocks(\n\t\t\t\ttopParentListBlock.clientId,\n\t\t\t\t[ head, middle, ...tail ],\n\t\t\t\t1\n\t\t\t);\n\t\t\t// We manually change the selection here because we are replacing\n\t\t\t// a different block than the selected one.\n\t\t\tselectionChange( middle.clientId );\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"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"}