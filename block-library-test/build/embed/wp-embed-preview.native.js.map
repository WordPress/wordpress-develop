{"version":3,"names":["_element","require","_components","observeAndResizeJS","WpEmbedPreview","html","rest","wpEmbedHtml","useMemo","doc","window","DOMParser","parseFromString","iframe","querySelector","removeAttribute","blockQuote","innerHTML","body","_react","createElement","SandBox","customJS","_default","exports","default","memo"],"sources":["@wordpress/block-library/src/embed/wp-embed-preview.native.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { memo, useMemo } from '@wordpress/element';\nimport { SandBox } from '@wordpress/components';\n\n/**\n * Checks for WordPress embed events signaling the height change when iframe\n * content loads or iframe's window is resized.  The event is sent from\n * WordPress core via the window.postMessage API.\n *\n * References:\n * window.postMessage: https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage\n * WordPress core embed-template on load: https://github.com/WordPress/WordPress/blob/HEAD/wp-includes/js/wp-embed-template.js#L143\n * WordPress core embed-template on resize: https://github.com/WordPress/WordPress/blob/HEAD/wp-includes/js/wp-embed-template.js#L187\n */\nconst observeAndResizeJS = `\n    ( function() {\n        if ( ! document.body || ! window.parent ) {\n            return;\n        }\n\n        function sendResize( { data: { secret, message, value } = {} } ) {\n            if (\n                [ secret, message, value ].some(\n                    ( attribute ) => ! attribute\n                ) ||\n                message !== 'height'\n            ) {\n                return;\n            }\n\n            document\n                .querySelectorAll( 'iframe[data-secret=\"' + secret + '\"' )\n                .forEach( ( iframe ) => {  \n                    if ( +iframe.height !== value ) {\n                        iframe.height = value;\n                    }\n                } );\n\n            // The function postMessage is exposed by the react-native-webview library \n            // to communicate between React Native and the WebView, in this case, \n            // we use it for notifying resize changes.\n            window.ReactNativeWebView.postMessage(JSON.stringify( {\n                action: 'resize',\n                height: value,\n            }));\n        }\n\n        window.addEventListener( 'message', sendResize );\n} )();`;\n\nfunction WpEmbedPreview( { html, ...rest } ) {\n\tconst wpEmbedHtml = useMemo( () => {\n\t\tconst doc = new window.DOMParser().parseFromString( html, 'text/html' );\n\t\tconst iframe = doc.querySelector( 'iframe' );\n\n\t\tif ( iframe ) {\n\t\t\tiframe.removeAttribute( 'style' );\n\t\t}\n\n\t\tconst blockQuote = doc.querySelector( 'blockquote' );\n\n\t\tif ( blockQuote ) {\n\t\t\tblockQuote.innerHTML = '';\n\t\t}\n\n\t\treturn doc.body.innerHTML;\n\t}, [ html ] );\n\n\treturn (\n\t\t<SandBox\n\t\t\tcustomJS={ observeAndResizeJS }\n\t\t\thtml={ wpEmbedHtml }\n\t\t\t{ ...rest }\n\t\t/>\n\t);\n}\n\nexport default memo( WpEmbedPreview );\n"],"mappings":";;;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AAJA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAME,kBAAkB,GAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AAEP,SAASC,cAAcA,CAAE;EAAEC,IAAI;EAAE,GAAGC;AAAK,CAAC,EAAG;EAC5C,MAAMC,WAAW,GAAG,IAAAC,gBAAO,EAAE,MAAM;IAClC,MAAMC,GAAG,GAAG,IAAIC,MAAM,CAACC,SAAS,CAAC,CAAC,CAACC,eAAe,CAAEP,IAAI,EAAE,WAAY,CAAC;IACvE,MAAMQ,MAAM,GAAGJ,GAAG,CAACK,aAAa,CAAE,QAAS,CAAC;IAE5C,IAAKD,MAAM,EAAG;MACbA,MAAM,CAACE,eAAe,CAAE,OAAQ,CAAC;IAClC;IAEA,MAAMC,UAAU,GAAGP,GAAG,CAACK,aAAa,CAAE,YAAa,CAAC;IAEpD,IAAKE,UAAU,EAAG;MACjBA,UAAU,CAACC,SAAS,GAAG,EAAE;IAC1B;IAEA,OAAOR,GAAG,CAACS,IAAI,CAACD,SAAS;EAC1B,CAAC,EAAE,CAAEZ,IAAI,CAAG,CAAC;EAEb,OACC,IAAAc,MAAA,CAAAC,aAAA,EAAClB,WAAA,CAAAmB,OAAO;IACPC,QAAQ,EAAGnB,kBAAoB;IAC/BE,IAAI,EAAGE,WAAa;IAAA,GACfD;EAAI,CACT,CAAC;AAEJ;AAAC,IAAAiB,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEc,IAAAC,aAAI,EAAEtB,cAAe,CAAC"}