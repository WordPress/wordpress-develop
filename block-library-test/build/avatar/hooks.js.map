{"version":3,"names":["_blockEditor","require","_coreData","_i18n","_data","getAvatarSizes","sizes","minSize","maxSize","length","maxSizeBuffer","Math","floor","useDefaultAvatar","avatarURL","defaultAvatarUrl","useSelect","select","getSettings","blockEditorStore","__experimentalDiscussionSettings","useCommentAvatar","commentId","avatars","useEntityProp","authorName","avatarUrls","Object","values","keys","defaultAvatar","src","alt","sprintf","__","useUserAvatar","userId","postId","postType","authorDetails","getEditedEntityRecord","getUser","coreStore","_authorId","author","avatar_urls","name"],"sources":["@wordpress/block-library/src/avatar/hooks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { store as coreStore, useEntityProp } from '@wordpress/core-data';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\n\nfunction getAvatarSizes( sizes ) {\n\tconst minSize = sizes ? sizes[ 0 ] : 24;\n\tconst maxSize = sizes ? sizes[ sizes.length - 1 ] : 96;\n\tconst maxSizeBuffer = Math.floor( maxSize * 2.5 );\n\treturn {\n\t\tminSize,\n\t\tmaxSize: maxSizeBuffer,\n\t};\n}\n\nfunction useDefaultAvatar() {\n\tconst { avatarURL: defaultAvatarUrl } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\n\t\treturn __experimentalDiscussionSettings;\n\t} );\n\treturn defaultAvatarUrl;\n}\n\nexport function useCommentAvatar( { commentId } ) {\n\tconst [ avatars ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_avatar_urls',\n\t\tcommentId\n\t);\n\n\tconst [ authorName ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_name',\n\t\tcommentId\n\t);\n\tconst avatarUrls = avatars ? Object.values( avatars ) : null;\n\tconst sizes = avatars ? Object.keys( avatars ) : null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\t// translators: %s is the Author name.\n\t\talt: authorName\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorName )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n\nexport function useUserAvatar( { userId, postId, postType } ) {\n\tconst { authorDetails } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEditedEntityRecord, getUser } = select( coreStore );\n\t\t\tif ( userId ) {\n\t\t\t\treturn {\n\t\t\t\t\tauthorDetails: getUser( userId ),\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst _authorId = getEditedEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\tpostType,\n\t\t\t\tpostId\n\t\t\t)?.author;\n\n\t\t\treturn {\n\t\t\t\tauthorDetails: _authorId ? getUser( _authorId ) : null,\n\t\t\t};\n\t\t},\n\t\t[ postType, postId, userId ]\n\t);\n\tconst avatarUrls = authorDetails?.avatar_urls\n\t\t? Object.values( authorDetails.avatar_urls )\n\t\t: null;\n\tconst sizes = authorDetails?.avatar_urls\n\t\t? Object.keys( authorDetails.avatar_urls )\n\t\t: null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\talt: authorDetails\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorDetails?.name )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n"],"mappings":"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"}