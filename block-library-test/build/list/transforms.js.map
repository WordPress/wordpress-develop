{"version":3,"names":["_blocks","require","_richText","_utils","getListContentSchema","phrasingContentSchema","listContentSchema","ul","ol","attributes","forEach","tag","children","li","getListContentFlat","blocks","flatMap","name","innerBlocks","content","transforms","from","type","isMultiBlock","transform","blockAttributes","childBlocks","length","map","createBlock","value","create","html","split","result","toHTMLString","anchor","selector","schema","args","createListBlockFromDOMElement","prefix","ordered","to","block","_attributes","_default","exports","default"],"sources":["@wordpress/block-library/src/list/transforms.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\nimport { create, split, toHTMLString } from '@wordpress/rich-text';\n\n/**\n * Internal dependencies\n */\nimport { createListBlockFromDOMElement } from './utils';\n\nfunction getListContentSchema( { phrasingContentSchema } ) {\n\tconst listContentSchema = {\n\t\t...phrasingContentSchema,\n\t\tul: {},\n\t\tol: { attributes: [ 'type', 'start', 'reversed' ] },\n\t};\n\n\t// Recursion is needed.\n\t// Possible: ul > li > ul.\n\t// Impossible: ul > ul.\n\t[ 'ul', 'ol' ].forEach( ( tag ) => {\n\t\tlistContentSchema[ tag ].children = {\n\t\t\tli: {\n\t\t\t\tchildren: listContentSchema,\n\t\t\t},\n\t\t};\n\t} );\n\n\treturn listContentSchema;\n}\n\nfunction getListContentFlat( blocks ) {\n\treturn blocks.flatMap( ( { name, attributes, innerBlocks = [] } ) => {\n\t\tif ( name === 'core/list-item' ) {\n\t\t\treturn [ attributes.content, ...getListContentFlat( innerBlocks ) ];\n\t\t}\n\t\treturn getListContentFlat( innerBlocks );\n\t} );\n}\n\nconst transforms = {\n\tfrom: [\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tisMultiBlock: true,\n\t\t\tblocks: [ 'core/paragraph', 'core/heading' ],\n\t\t\ttransform: ( blockAttributes ) => {\n\t\t\t\tlet childBlocks = [];\n\t\t\t\tif ( blockAttributes.length > 1 ) {\n\t\t\t\t\tchildBlocks = blockAttributes.map( ( { content } ) => {\n\t\t\t\t\t\treturn createBlock( 'core/list-item', { content } );\n\t\t\t\t\t} );\n\t\t\t\t} else if ( blockAttributes.length === 1 ) {\n\t\t\t\t\tconst value = create( {\n\t\t\t\t\t\thtml: blockAttributes[ 0 ].content,\n\t\t\t\t\t} );\n\t\t\t\t\tchildBlocks = split( value, '\\n' ).map( ( result ) => {\n\t\t\t\t\t\treturn createBlock( 'core/list-item', {\n\t\t\t\t\t\t\tcontent: toHTMLString( { value: result } ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn createBlock(\n\t\t\t\t\t'core/list',\n\t\t\t\t\t{\n\t\t\t\t\t\tanchor: blockAttributes.anchor,\n\t\t\t\t\t},\n\t\t\t\t\tchildBlocks\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'raw',\n\t\t\tselector: 'ol,ul',\n\t\t\tschema: ( args ) => ( {\n\t\t\t\tol: getListContentSchema( args ).ol,\n\t\t\t\tul: getListContentSchema( args ).ul,\n\t\t\t} ),\n\t\t\ttransform: createListBlockFromDOMElement,\n\t\t},\n\t\t...[ '*', '-' ].map( ( prefix ) => ( {\n\t\t\ttype: 'prefix',\n\t\t\tprefix,\n\t\t\ttransform( content ) {\n\t\t\t\treturn createBlock( 'core/list', {}, [\n\t\t\t\t\tcreateBlock( 'core/list-item', { content } ),\n\t\t\t\t] );\n\t\t\t},\n\t\t} ) ),\n\t\t...[ '1.', '1)' ].map( ( prefix ) => ( {\n\t\t\ttype: 'prefix',\n\t\t\tprefix,\n\t\t\ttransform( content ) {\n\t\t\t\treturn createBlock(\n\t\t\t\t\t'core/list',\n\t\t\t\t\t{\n\t\t\t\t\t\tordered: true,\n\t\t\t\t\t},\n\t\t\t\t\t[ createBlock( 'core/list-item', { content } ) ]\n\t\t\t\t);\n\t\t\t},\n\t\t} ) ),\n\t],\n\tto: [\n\t\t...[ 'core/paragraph', 'core/heading' ].map( ( block ) => ( {\n\t\t\ttype: 'block',\n\t\t\tblocks: [ block ],\n\t\t\ttransform: ( _attributes, childBlocks ) => {\n\t\t\t\treturn getListContentFlat( childBlocks ).map( ( content ) =>\n\t\t\t\t\tcreateBlock( block, {\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t} )\n\t\t\t\t);\n\t\t\t},\n\t\t} ) ),\n\t],\n};\n\nexport default transforms;\n"],"mappings":"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"}