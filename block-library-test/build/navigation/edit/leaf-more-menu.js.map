{"version":3,"names":["_blocks","require","_icons","_components","_data","_i18n","_blockEditor","POPOVER_PROPS","className","placement","BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU","AddSubmenuItem","block","onClose","expandedState","expand","setInsertedBlock","insertBlock","replaceBlock","replaceInnerBlocks","useDispatch","blockEditorStore","clientId","isDisabled","includes","name","_react","createElement","MenuItem","icon","addSubmenu","disabled","onClick","updateSelectionOnInsert","newLink","createBlock","innerBlocks","length","newSubmenu","attributes","__","LeafMoreMenu","props","moveBlocksDown","moveBlocksUp","removeBlocks","removeLabel","sprintf","BlockTitle","maximumLength","rootClientId","useSelect","select","getBlockRootClientId","DropdownMenu","moreVertical","label","popoverProps","noIcons","Fragment","MenuGroup","chevronUp","chevronDown","expanded"],"sources":["@wordpress/block-library/src/navigation/edit/leaf-more-menu.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\nimport {\n\taddSubmenu,\n\tchevronUp,\n\tchevronDown,\n\tmoreVertical,\n} from '@wordpress/icons';\nimport { DropdownMenu, MenuItem, MenuGroup } from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { BlockTitle, store as blockEditorStore } from '@wordpress/block-editor';\n\nconst POPOVER_PROPS = {\n\tclassName: 'block-editor-block-settings-menu__popover',\n\tplacement: 'bottom-start',\n};\n\nconst BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU = [\n\t'core/navigation-link',\n\t'core/navigation-submenu',\n];\n\nfunction AddSubmenuItem( {\n\tblock,\n\tonClose,\n\texpandedState,\n\texpand,\n\tsetInsertedBlock,\n} ) {\n\tconst { insertBlock, replaceBlock, replaceInnerBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tconst clientId = block.clientId;\n\tconst isDisabled = ! BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU.includes(\n\t\tblock.name\n\t);\n\treturn (\n\t\t<MenuItem\n\t\t\ticon={ addSubmenu }\n\t\t\tdisabled={ isDisabled }\n\t\t\tonClick={ () => {\n\t\t\t\tconst updateSelectionOnInsert = false;\n\t\t\t\tconst newLink = createBlock( 'core/navigation-link' );\n\n\t\t\t\tif ( block.name === 'core/navigation-submenu' ) {\n\t\t\t\t\tinsertBlock(\n\t\t\t\t\t\tnewLink,\n\t\t\t\t\t\tblock.innerBlocks.length,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t\tupdateSelectionOnInsert\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Convert to a submenu if the block currently isn't one.\n\t\t\t\t\tconst newSubmenu = createBlock(\n\t\t\t\t\t\t'core/navigation-submenu',\n\t\t\t\t\t\tblock.attributes,\n\t\t\t\t\t\tblock.innerBlocks\n\t\t\t\t\t);\n\n\t\t\t\t\t// The following must happen as two independent actions.\n\t\t\t\t\t// Why? Because the offcanvas editor relies on the getLastInsertedBlocksClientIds\n\t\t\t\t\t// selector to determine which block is \"active\". As the UX needs the newLink to be\n\t\t\t\t\t// the \"active\" block it must be the last block to be inserted.\n\t\t\t\t\t// Therefore the Submenu is first created and **then** the newLink is inserted\n\t\t\t\t\t// thus ensuring it is the last inserted block.\n\t\t\t\t\treplaceBlock( clientId, newSubmenu );\n\n\t\t\t\t\treplaceInnerBlocks(\n\t\t\t\t\t\tnewSubmenu.clientId,\n\t\t\t\t\t\t[ newLink ],\n\t\t\t\t\t\tupdateSelectionOnInsert\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// This call sets the local List View state for the \"last inserted block\".\n\t\t\t\t// This is required for the Nav Block to determine whether or not to display\n\t\t\t\t// the Link UI for this new block.\n\t\t\t\tsetInsertedBlock( newLink );\n\n\t\t\t\tif ( ! expandedState[ block.clientId ] ) {\n\t\t\t\t\texpand( block.clientId );\n\t\t\t\t}\n\t\t\t\tonClose();\n\t\t\t} }\n\t\t>\n\t\t\t{ __( 'Add submenu link' ) }\n\t\t</MenuItem>\n\t);\n}\n\nexport default function LeafMoreMenu( props ) {\n\tconst { block } = props;\n\tconst { clientId } = block;\n\n\tconst { moveBlocksDown, moveBlocksUp, removeBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tconst removeLabel = sprintf(\n\t\t/* translators: %s: block name */\n\t\t__( 'Remove %s' ),\n\t\tBlockTitle( { clientId, maximumLength: 25 } )\n\t);\n\n\tconst rootClientId = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockRootClientId } = select( blockEditorStore );\n\n\t\t\treturn getBlockRootClientId( clientId );\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\treturn (\n\t\t<DropdownMenu\n\t\t\ticon={ moreVertical }\n\t\t\tlabel={ __( 'Options' ) }\n\t\t\tclassName=\"block-editor-block-settings-menu\"\n\t\t\tpopoverProps={ POPOVER_PROPS }\n\t\t\tnoIcons\n\t\t\t{ ...props }\n\t\t>\n\t\t\t{ ( { onClose } ) => (\n\t\t\t\t<>\n\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\ticon={ chevronUp }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tmoveBlocksUp( [ clientId ], rootClientId );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Move up' ) }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\ticon={ chevronDown }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tmoveBlocksDown( [ clientId ], rootClientId );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Move down' ) }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t<AddSubmenuItem\n\t\t\t\t\t\t\tblock={ block }\n\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t\texpanded\n\t\t\t\t\t\t\texpandedState={ props.expandedState }\n\t\t\t\t\t\t\texpand={ props.expand }\n\t\t\t\t\t\t\tsetInsertedBlock={ props.setInsertedBlock }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tremoveBlocks( [ clientId ], false );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ removeLabel }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t</MenuGroup>\n\t\t\t\t</>\n\t\t\t) }\n\t\t</DropdownMenu>\n\t);\n}\n"],"mappings":"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"}