{"version":3,"names":["_reactNative","require","_galleryImage","_interopRequireDefault","_deprecated","_galleryStyles","_tiles","_i18n","_blockEditor","_element","_reactNativeBridge","_data","_components","TILE_SPACING","MAX_DISPLAYED_COLUMNS","MAX_DISPLAYED_COLUMNS_NARROW","isFullWidth","alignmentHelpers","Gallery","props","isCaptionSelected","setIsCaptionSelected","useState","useEffect","mediaUploadSync","isRTL","useSelect","select","blockEditorStore","getSettings","clientId","selectedImage","mediaPlaceholder","onBlur","onMoveBackward","onMoveForward","onRemoveImage","onSelectImage","onSetImageAttributes","onFocusGalleryCaption","attributes","isSelected","isNarrow","onFocus","insertBlocksAfter","align","columns","defaultColumnsNumberV1","imageCrop","images","displayedColumns","Math","min","selectImage","index","focusGalleryCaption","_react","createElement","View","style","flex","default","spacing","styles","galleryTilesContainerSelected","undefined","map","img","ariaLabel","sprintf","__","length","key","id","url","alt","parseInt","isCropped","isFirstItem","isLastItem","isBlockSelected","onRemove","onSelect","onSelectBlock","setAttributes","attrs","caption","fullWidth","BlockCaption","accessible","accessibilityLabelCreator","RichText","isEmpty","exports","_default"],"sources":["@wordpress/block-library/src/gallery/v1/gallery.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport GalleryImage from './gallery-image';\nimport { defaultColumnsNumberV1 } from '../deprecated';\nimport styles from './gallery-styles.scss';\nimport Tiles from './tiles';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport {\n\tBlockCaption,\n\tRichText,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { useState, useEffect } from '@wordpress/element';\nimport { mediaUploadSync } from '@wordpress/react-native-bridge';\nimport { useSelect } from '@wordpress/data';\nimport { alignmentHelpers } from '@wordpress/components';\n\nconst TILE_SPACING = 15;\n\n// we must limit displayed columns since readable content max-width is 580px\nconst MAX_DISPLAYED_COLUMNS = 4;\nconst MAX_DISPLAYED_COLUMNS_NARROW = 2;\n\nconst { isFullWidth } = alignmentHelpers;\n\nexport const Gallery = ( props ) => {\n\tconst [ isCaptionSelected, setIsCaptionSelected ] = useState( false );\n\tuseEffect( mediaUploadSync, [] );\n\n\tconst isRTL = useSelect( ( select ) => {\n\t\treturn !! select( blockEditorStore ).getSettings().isRTL;\n\t}, [] );\n\n\tconst {\n\t\tclientId,\n\t\tselectedImage,\n\t\tmediaPlaceholder,\n\t\tonBlur,\n\t\tonMoveBackward,\n\t\tonMoveForward,\n\t\tonRemoveImage,\n\t\tonSelectImage,\n\t\tonSetImageAttributes,\n\t\tonFocusGalleryCaption,\n\t\tattributes,\n\t\tisSelected,\n\t\tisNarrow,\n\t\tonFocus,\n\t\tinsertBlocksAfter,\n\t} = props;\n\n\tconst {\n\t\talign,\n\t\tcolumns = defaultColumnsNumberV1( attributes ),\n\t\timageCrop,\n\t\timages,\n\t} = attributes;\n\n\t// limit displayed columns when isNarrow is true (i.e. when viewport width is\n\t// less than \"small\", where small = 600)\n\tconst displayedColumns = isNarrow\n\t\t? Math.min( columns, MAX_DISPLAYED_COLUMNS_NARROW )\n\t\t: Math.min( columns, MAX_DISPLAYED_COLUMNS );\n\n\tconst selectImage = ( index ) => {\n\t\treturn () => {\n\t\t\tif ( isCaptionSelected ) {\n\t\t\t\tsetIsCaptionSelected( false );\n\t\t\t}\n\t\t\t// We need to fully invoke the curried function here.\n\t\t\tonSelectImage( index )();\n\t\t};\n\t};\n\n\tconst focusGalleryCaption = () => {\n\t\tif ( ! isCaptionSelected ) {\n\t\t\tsetIsCaptionSelected( true );\n\t\t}\n\t\tonFocusGalleryCaption();\n\t};\n\n\treturn (\n\t\t<View style={ { flex: 1 } }>\n\t\t\t<Tiles\n\t\t\t\tcolumns={ displayedColumns }\n\t\t\t\tspacing={ TILE_SPACING }\n\t\t\t\tstyle={\n\t\t\t\t\tisSelected\n\t\t\t\t\t\t? styles.galleryTilesContainerSelected\n\t\t\t\t\t\t: undefined\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{ images.map( ( img, index ) => {\n\t\t\t\t\tconst ariaLabel = sprintf(\n\t\t\t\t\t\t/* translators: 1: the order number of the image. 2: the total number of images. */\n\t\t\t\t\t\t__( 'image %1$d of %2$d in gallery' ),\n\t\t\t\t\t\tindex + 1,\n\t\t\t\t\t\timages.length\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<GalleryImage\n\t\t\t\t\t\t\tkey={ img.id ? `${ img.id }-${ index }` : img.url }\n\t\t\t\t\t\t\turl={ img.url }\n\t\t\t\t\t\t\talt={ img.alt }\n\t\t\t\t\t\t\tid={ parseInt( img.id, 10 ) } // make id an integer explicitly\n\t\t\t\t\t\t\tisCropped={ imageCrop }\n\t\t\t\t\t\t\tisFirstItem={ index === 0 }\n\t\t\t\t\t\t\tisLastItem={ index + 1 === images.length }\n\t\t\t\t\t\t\tisSelected={ isSelected && selectedImage === index }\n\t\t\t\t\t\t\tisBlockSelected={ isSelected }\n\t\t\t\t\t\t\tonMoveBackward={ onMoveBackward( index ) }\n\t\t\t\t\t\t\tonMoveForward={ onMoveForward( index ) }\n\t\t\t\t\t\t\tonRemove={ onRemoveImage( index ) }\n\t\t\t\t\t\t\tonSelect={ selectImage( index ) }\n\t\t\t\t\t\t\tonSelectBlock={ onFocus }\n\t\t\t\t\t\t\tsetAttributes={ ( attrs ) =>\n\t\t\t\t\t\t\t\tonSetImageAttributes( index, attrs )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcaption={ img.caption }\n\t\t\t\t\t\t\taria-label={ ariaLabel }\n\t\t\t\t\t\t\tisRTL={ isRTL }\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t</Tiles>\n\t\t\t<View style={ isFullWidth( align ) && styles.fullWidth }>\n\t\t\t\t{ mediaPlaceholder }\n\t\t\t</View>\n\t\t\t<BlockCaption\n\t\t\t\tclientId={ clientId }\n\t\t\t\tisSelected={ isCaptionSelected }\n\t\t\t\taccessible={ true }\n\t\t\t\taccessibilityLabelCreator={ ( caption ) =>\n\t\t\t\t\tRichText.isEmpty( caption )\n\t\t\t\t\t\t? /* translators: accessibility text. Empty gallery caption. */\n\t\t\t\t\t\t  'Gallery caption. Empty'\n\t\t\t\t\t\t: sprintf(\n\t\t\t\t\t\t\t\t/* translators: accessibility text. %s: gallery caption. */\n\t\t\t\t\t\t\t\t__( 'Gallery caption. %s' ),\n\t\t\t\t\t\t\t\tcaption\n\t\t\t\t\t\t  )\n\t\t\t\t}\n\t\t\t\tonFocus={ focusGalleryCaption }\n\t\t\t\tonBlur={ onBlur } // Always assign onBlur as props.\n\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t/>\n\t\t</View>\n\t);\n};\n\nexport default Gallery;\n"],"mappings":"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"}